language: go

os:
  - linux

go:
  - "1.12"

install: true

services: docker

jobs:
  include:
    - stage: integration tests
      before_script:
        - curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl && chmod +x kubectl && sudo mv kubectl /usr/local/bin/
        - curl -Lo ./kind "https://kind.sigs.k8s.io/dl/v0.8.0/kind-linux-amd64"
        - chmod +x ./kind
        - mv ./kind $(go env GOPATH)/bin
        - kind create cluster --name k8s-yk-kind
        - kubectl cluster-info --context k8s-yk-kind
      script: kubectl get nodes